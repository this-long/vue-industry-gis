(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-637549a2"],{"0cb2":function(e,r,t){var a=t("e330"),l=t("7b0b"),n=Math.floor,o=a("".charAt),i=a("".replace),s=a("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,p=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,r,t,a,c,m){var d=t+e.length,g=a.length,f=p;return void 0!==c&&(c=l(c),f=u),i(m,f,(function(l,i){var u;switch(o(i,0)){case"$":return"$";case"&":return e;case"`":return s(r,0,t);case"'":return s(r,d);case"<":u=c[s(i,1,-1)];break;default:var p=+i;if(0===p)return l;if(p>g){var m=n(p/10);return 0===m?l:m<=g?void 0===a[m-1]?o(i,1):a[m-1]+o(i,1):l}u=a[p-1]}return void 0===u?"":u}))}},1276:function(e,r,t){"use strict";var a=t("2ba4"),l=t("c65b"),n=t("e330"),o=t("d784"),i=t("44e7"),s=t("825a"),u=t("1d80"),p=t("4840"),c=t("8aa5"),m=t("50c4"),d=t("577e"),g=t("dc4a"),f=t("f36a"),b=t("14c3"),v=t("9263"),h=t("9f7f"),y=t("d039"),F=h.UNSUPPORTED_Y,x=4294967295,$=Math.min,w=[].push,k=n(/./.exec),C=n(w),j=n("".slice),I=!y((function(){var e=/(?:)/,r=e.exec;e.exec=function(){return r.apply(this,arguments)};var t="ab".split(e);return 2!==t.length||"a"!==t[0]||"b"!==t[1]}));o("split",(function(e,r,t){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var n=d(u(this)),o=void 0===t?x:t>>>0;if(0===o)return[];if(void 0===e)return[n];if(!i(e))return l(r,n,e,o);var s,p,c,m=[],g=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),b=0,h=new RegExp(e.source,g+"g");while(s=l(v,h,n)){if(p=h.lastIndex,p>b&&(C(m,j(n,b,s.index)),s.length>1&&s.index<n.length&&a(w,m,f(s,1)),c=s[0].length,b=p,m.length>=o))break;h.lastIndex===s.index&&h.lastIndex++}return b===n.length?!c&&k(h,"")||C(m,""):C(m,j(n,b)),m.length>o?f(m,0,o):m}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:l(r,this,e,t)}:r,[function(r,t){var a=u(this),o=void 0==r?void 0:g(r,e);return o?l(o,r,a,t):l(n,d(a),r,t)},function(e,a){var l=s(this),o=d(e),i=t(n,l,o,a,n!==r);if(i.done)return i.value;var u=p(l,RegExp),g=l.unicode,f=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(F?"g":"y"),v=new u(F?"^(?:"+l.source+")":l,f),h=void 0===a?x:a>>>0;if(0===h)return[];if(0===o.length)return null===b(v,o)?[o]:[];var y=0,w=0,k=[];while(w<o.length){v.lastIndex=F?0:w;var I,A=b(v,F?j(o,w):o);if(null===A||(I=$(m(v.lastIndex+(F?w:0)),o.length))===y)w=c(o,w,g);else{if(C(k,j(o,y,w)),k.length===h)return k;for(var O=1;O<=A.length-1;O++)if(C(k,A[O]),k.length===h)return k;w=y=I}}return C(k,j(o,y)),k}]}),!I,F)},"346b":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"heritage-apply"},[t("div",{staticClass:"heritage-apply-top"},[t("MainTop",[e._v("遗产申请 "),t("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" 遗产申报")])],1),t("div",{staticClass:"heritage-apply-bottom padding15"},[t("el-alert",{attrs:{title:"zh_cn"===e.lang?"为了您的申请能通过审核，请确保您的信息真实有效":"In order for your application to pass the examination, please ensure that your information is true and valid",type:"info"}}),t("br"),t("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.applyCoordinate.length,expression:"applyCoordinate.length === 0"}],attrs:{type:"primary"},on:{click:e.getapplyCoordinateP}},[e._v("点击拾取遗产坐标位置")]),t("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.applyCoordinate.length,expression:"applyCoordinate.length !== 0"}],staticClass:"main-box"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{size:"mini",model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"申请人姓名",prop:"applyName"}},[t("el-input",{attrs:{placeholder:"请输入申请人或申请公司"},model:{value:e.ruleForm.applyName,callback:function(r){e.$set(e.ruleForm,"applyName",r)},expression:"ruleForm.applyName"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{attrs:{placeholder:"手机号主要用于审核时与您的联系"},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{label:"添加类型",prop:"addType"}},[t("el-radio-group",{model:{value:e.ruleForm.addType,callback:function(r){e.$set(e.ruleForm,"addType",r)},expression:"ruleForm.addType"}},[t("el-radio",{attrs:{label:"工业遗产"}}),t("el-radio",{attrs:{label:"遗产博物馆"}}),t("el-radio",{attrs:{label:"工业旅游区"}})],1)],1),t("el-form-item",{attrs:{label:"遗产名称",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"坐标经度",prop:"jing"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.jing,callback:function(r){e.$set(e.ruleForm,"jing",r)},expression:"ruleForm.jing"}})],1),t("el-form-item",{attrs:{label:"坐标纬度",prop:"wei"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.wei,callback:function(r){e.$set(e.ruleForm,"wei",r)},expression:"ruleForm.wei"}}),t("el-button",{staticStyle:{"margin-left":"10px"},on:{click:e.getapplyCoordinateP}},[e._v("重新拾取")])],1),t("el-form-item",{attrs:{label:"所在地址",prop:"address"}},[t("el-input",{model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}})],1),t("el-form-item",{attrs:{label:"始建年份",prop:"start"}},[t("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"选择年"},model:{value:e.ruleForm.start,callback:function(r){e.$set(e.ruleForm,"start",r)},expression:"ruleForm.start"}})],1),t("el-form-item",{attrs:{label:"遗产类型",prop:"type"}},[t("el-input",{model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}})],1),t("el-form-item",{attrs:{label:"所属公司",prop:"company"}},[t("el-input",{model:{value:e.ruleForm.company,callback:function(r){e.$set(e.ruleForm,"company",r)},expression:"ruleForm.company"}})],1),t("el-form-item",{attrs:{label:"保护等级及再利用情况"}},[t("el-input",{model:{value:e.ruleForm.prolevel,callback:function(r){e.$set(e.ruleForm,"prolevel",r)},expression:"ruleForm.prolevel"}})],1),t("el-form-item",{attrs:{label:"工业旅游示范点等级"}},[t("el-input",{model:{value:e.ruleForm.trvlevel,callback:function(r){e.$set(e.ruleForm,"trvlevel",r)},expression:"ruleForm.trvlevel"}})],1),t("el-form-item",{attrs:{label:"旅游景区等级"}},[t("el-rate",{attrs:{texts:["1A景区","2A景区","3A景区","4A景区","5A景区"],"show-text":""},model:{value:e.ruleForm.scelevel,callback:function(r){e.$set(e.ruleForm,"scelevel",r)},expression:"ruleForm.scelevel"}})],1),t("el-form-item",{attrs:{label:"遗产简介",prop:"brief"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入遗产简介"},model:{value:e.ruleForm.brief,callback:function(r){e.$set(e.ruleForm,"brief",r)},expression:"ruleForm.brief"}})],1),t("el-form-item",{attrs:{label:"详细介绍",prop:"details"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入详细介绍"},model:{value:e.ruleForm.details,callback:function(r){e.$set(e.ruleForm,"details",r)},expression:"ruleForm.details"}})],1),t("el-divider"),t("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择封面图片，注意封面图片仅允许上传一张，多次上传仅最后一张图会展示":"Please select a cover image. Note that only one cover image can be uploaded, and only the last image will be displayed after multiple uploads",type:"info"}}),t("br"),t("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.mainImage}}),t("br"),t("el-divider"),t("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择工业遗产详细图片，可以上传多张":"Please select a detailed picture of industrial heritage. You can upload multiple pictures",type:"info"}}),t("br"),t("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.addImagesAll}}),t("el-divider"),t("div",{staticClass:"subBtn"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("清空提示")])],1)],1)],1)],1)])},l=[],n=t("1da1"),o=t("5530"),i=(t("ac1f"),t("5319"),t("1276"),t("d81d"),t("a15b"),t("b0c0"),t("96cf"),t("2f62")),s=t("b2df"),u={components:{MainTop:s["a"]},computed:Object(o["a"])({},Object(i["c"])(["lang","applyCoordinate"])),created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log(sessionStorage.getItem("username")),!e.$route.query.applyId){r.next=7;break}return r.next=4,e.$axios.post("/getOneApplyHeritage/getOneApplyHeritage",{_id:e.$route.query.applyId});case 4:t=r.sent,e.getapplyCoordinate(t.data.data[0].coordinate),e.ruleForm=Object(o["a"])({},t.data.data[0]);case 7:e.changeCoordinateType("apply"),e.ruleForm.jing=e.applyCoordinate[0],e.ruleForm.wei=e.applyCoordinate[1];case 10:case"end":return r.stop()}}),r)})))()},data:function(){return{ruleForm:{applyName:"",phone:"",addType:"",name:"",address:"",type:"",company:"",jing:0,wei:0,start:"",prolevel:"",trvlevel:"",scelevel:null,brief:"",details:"",mainImage:"",imagesAllurl:[],coordinate:[],approvalStatus:"pending",approvalComments:"",rejectComment:""},rules:{applyName:[{required:!0,message:"请输入申请人",trigger:"blur"}],phone:[{required:!0,message:"请输入正确手机号",trigger:"blur"}],addType:[{required:!0,message:"请选择添加类型",trigger:"change"}],name:[{required:!0,message:"请输入工业遗产名称",trigger:"blur"},{min:3,message:"长度在不少于3个字符",trigger:"blur"}],address:[{required:!0,message:"请选择工业遗产所在地址",trigger:"blur"}],type:[{required:!0,message:"请输入工业遗产类型",trigger:"blur"}],company:[{required:!0,message:"请输入工业遗产所属公司",trigger:"blur"}],start:[{required:!0,message:"请选择遗产始建年份",trigger:"blur"}],brief:[{required:!0,message:"请输入工业遗产简介",trigger:"blur"}],details:[{required:!0,message:"请输入工业遗产详细介绍",trigger:"blur"}],jing:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}],wei:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}]},editData:[]}},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])(["changeCoordinateType","getCoordinate","getapplyCoordinate"])),{},{getapplyCoordinateP:function(){this.getCoordinate([]),this.$router.push("/get/coordinate")},submitForm:function(e){var r=this;this.$refs[e].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,l,n,i,s,u,p,c,m,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=25;break}if(""===r.ruleForm.mainImage||0===r.ruleForm.imagesAllurl.length){e.next=22;break}if(""!==r.ruleForm.brief?(a=/\n/g,r.ruleForm.brief=r.ruleForm.brief.replace(a,"<br>"),console.log(r.ruleForm.brief.split("<br>")),l=r.ruleForm.brief.split("<br>"),n=l.map((function(e){return"<p class='test'>"+e+"</p>"})),i=n.join(""),r.ruleForm.brief=i):r.$message.error("请完善遗产简介"),""!==r.ruleForm.details?(s=/\n/g,r.ruleForm.details=r.ruleForm.details.replace(s,"<br>"),console.log(r.ruleForm.details.split("<br>")),u=r.ruleForm.details.split("<br>"),p=u.map((function(e){return"<p class='test'>"+e+"</p>"})),c=p.join(""),r.ruleForm.details=c):r.$message.error("请完善遗产简介"),r.ruleForm.coordinate=[r.ruleForm.jing,r.ruleForm.wei],console.log(r.ruleForm),r.$route.query.applyId){e.next=14;break}return e.next=9,r.$axios.post("/postApplyHeritageData/postApplyHeritageData",Object(o["a"])(Object(o["a"])({},r.ruleForm),{},{user:sessionStorage.getItem("username")}));case 9:m=e.sent,console.log("res----",m),200===m.status&&(r.$message({message:"申报信息提交成功，请耐心等待审核",type:"success"}),r.getapplyCoordinate([]),r.getCoordinate([]),r.$router.push("/heritage/myapply")),e.next=20;break;case 14:return r.ruleForm.approvalStatus="pending",e.next=17,r.$axios.post("/editApplyHeritage/editApplyHeritage",Object(o["a"])(Object(o["a"])({},r.ruleForm),{},{user:sessionStorage.getItem("username")}));case 17:d=e.sent,200===d.status&&(r.$message({message:"编辑信息提交成功，请耐心等待审核",type:"success"}),r.getapplyCoordinate([]),r.getCoordinate([]),r.$router.push("/heritage/myapply")),console.log(r.ruleForm);case 20:e.next=23;break;case 22:r.$message.error("请上传遗产相关图片");case 23:e.next=27;break;case 25:return console.log("error submit!!"),e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},mainImage:function(e){var r=this,t=e.target.files[0];console.log(t);var a=new FileReader;a.readAsDataURL(t),a.onload=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var l,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=r.src=a.target.result,e.next=3,r.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:l,name:t.name});case 3:n=e.sent,200===n.status?(console.log(n),r.$message({message:"图片上传成功",type:"success"}),r.ruleForm.mainImage=n.data.fileID):r.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},addImagesAll:function(e){var r=this,t=e.target.files[0];console.log(t);var a=new FileReader;a.readAsDataURL(t),a.onload=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var l,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=r.src=a.target.result,e.next=3,r.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:l,name:t.name});case 3:n=e.sent,200===n.status?(r.$message({message:"图片上传成功",type:"success"}),r.ruleForm.imagesAllurl.push(n.data.fileID)):r.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}})},p=u,c=t("2877"),m=Object(c["a"])(p,a,l,!1,null,null,null);r["default"]=m.exports},"44e7":function(e,r,t){var a=t("861d"),l=t("c6b6"),n=t("b622"),o=n("match");e.exports=function(e){var r;return a(e)&&(void 0!==(r=e[o])?!!r:"RegExp"==l(e))}},5319:function(e,r,t){"use strict";var a=t("2ba4"),l=t("c65b"),n=t("e330"),o=t("d784"),i=t("d039"),s=t("825a"),u=t("1626"),p=t("5926"),c=t("50c4"),m=t("577e"),d=t("1d80"),g=t("8aa5"),f=t("dc4a"),b=t("0cb2"),v=t("14c3"),h=t("b622"),y=h("replace"),F=Math.max,x=Math.min,$=n([].concat),w=n([].push),k=n("".indexOf),C=n("".slice),j=function(e){return void 0===e?e:String(e)},I=function(){return"$0"==="a".replace(/./,"$0")}(),A=function(){return!!/./[y]&&""===/./[y]("a","$0")}(),O=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));o("replace",(function(e,r,t){var n=A?"$":"$0";return[function(e,t){var a=d(this),n=void 0==e?void 0:f(e,y);return n?l(n,e,a,t):l(r,m(a),e,t)},function(e,l){var o=s(this),i=m(e);if("string"==typeof l&&-1===k(l,n)&&-1===k(l,"$<")){var d=t(r,o,i,l);if(d.done)return d.value}var f=u(l);f||(l=m(l));var h=o.global;if(h){var y=o.unicode;o.lastIndex=0}var I=[];while(1){var A=v(o,i);if(null===A)break;if(w(I,A),!h)break;var O=m(A[0]);""===O&&(o.lastIndex=g(i,c(o.lastIndex),y))}for(var R="",q=0,_=0;_<I.length;_++){A=I[_];for(var T=m(A[0]),N=F(x(p(A.index),i.length),0),S=[],D=1;D<A.length;D++)w(S,j(A[D]));var P=A.groups;if(f){var z=$([T],S,N,i);void 0!==P&&w(z,P);var H=m(a(l,void 0,z))}else H=b(T,i,N,S,P,l);N>=q&&(R+=C(i,q,N)+H,q=N+T.length)}return R+C(i,q)}]}),!O||!I||A)},"8aa5":function(e,r,t){"use strict";var a=t("6547").charAt;e.exports=function(e,r,t){return r+(t?a(e,r).length:1)}}}]);
//# sourceMappingURL=chunk-637549a2.01558252.js.map