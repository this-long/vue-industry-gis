(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bb225944"],{"003b":function(e,t,a){"use strict";a("a2e1")},"011a":function(e,t,a){},"13ee":function(e,t,a){"use strict";a("011a")},"359e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"HeritageAdd"},[a("div",{staticClass:"HeritageAdd-top"},[a("MainTop",[e._v(e._s("zh_cn"===e.lang?"数据维护":"Data maintenance")+" "),a("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" "+e._s("zh_cn"===e.lang?"遗产管理":"Heritage Management")),a("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" "+e._s("zh_cn"===e.lang?"遗产添加":"Heritage Add"))])],1),a("div",{staticClass:"HeritageAdd-bottom padding15"},[a("el-alert",{attrs:{title:"zh_cn"===e.lang?"填写工业遗产、博物馆或工业旅游区的相关信息来添加一项遗产数据":"Fill in information about industrial heritage, museums or industrial tourist areas to add a heritage data",type:"info"}}),a("br",{directives:[{name:"show",rawName:"v-show",value:0===e.newCoordinate.length,expression:"newCoordinate.length === 0"}]}),a("el-alert",{directives:[{name:"show",rawName:"v-show",value:0===e.newCoordinate.length,expression:"newCoordinate.length === 0"}],attrs:{title:"zh_cn"===e.lang?"请先拾取要添加的工业遗产的地理坐标":"Please pick the geographical coordinates of the industrial heritage to be added first",type:"info"}}),a("br"),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.newCoordinate.length,expression:"newCoordinate.length === 0"}],attrs:{type:"primary"},on:{click:e.getCoordinateP}},[e._v("拾取遗产坐标位置")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.newCoordinate.length,expression:"newCoordinate.length !== 0"}],staticClass:"main-box"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{size:"mini",model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"添加类型",prop:"addType"}},[a("el-radio-group",{model:{value:e.ruleForm.addType,callback:function(t){e.$set(e.ruleForm,"addType",t)},expression:"ruleForm.addType"}},[a("el-radio",{attrs:{label:"工业遗产"}}),a("el-radio",{attrs:{label:"遗产博物馆"}}),a("el-radio",{attrs:{label:"工业旅游区"}})],1)],1),a("el-form-item",{attrs:{label:"遗产名称",prop:"name"}},[a("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"坐标经度",prop:"jing"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.jing,callback:function(t){e.$set(e.ruleForm,"jing",t)},expression:"ruleForm.jing"}})],1),a("el-form-item",{attrs:{label:"坐标纬度",prop:"wei"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.wei,callback:function(t){e.$set(e.ruleForm,"wei",t)},expression:"ruleForm.wei"}}),a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:e.getCoordinateP}},[e._v("重新拾取")])],1),a("el-form-item",{attrs:{label:"所在地址",prop:"address"}},[a("el-input",{model:{value:e.ruleForm.address,callback:function(t){e.$set(e.ruleForm,"address",t)},expression:"ruleForm.address"}})],1),a("el-form-item",{attrs:{label:"始建年份",prop:"start"}},[a("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"选择年"},model:{value:e.ruleForm.start,callback:function(t){e.$set(e.ruleForm,"start",t)},expression:"ruleForm.start"}})],1),a("el-form-item",{attrs:{label:"遗产类型",prop:"type"}},[a("el-input",{model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}})],1),a("el-form-item",{attrs:{label:"所属公司",prop:"company"}},[a("el-input",{model:{value:e.ruleForm.company,callback:function(t){e.$set(e.ruleForm,"company",t)},expression:"ruleForm.company"}})],1),a("el-form-item",{attrs:{label:"保护等级及再利用情况"}},[a("el-input",{model:{value:e.ruleForm.prolevel,callback:function(t){e.$set(e.ruleForm,"prolevel",t)},expression:"ruleForm.prolevel"}})],1),a("el-form-item",{attrs:{label:"工业旅游示范点等级"}},[a("el-input",{model:{value:e.ruleForm.trvlevel,callback:function(t){e.$set(e.ruleForm,"trvlevel",t)},expression:"ruleForm.trvlevel"}})],1),a("el-form-item",{attrs:{label:"旅游景区等级"}},[a("el-rate",{attrs:{texts:["1A景区","2A景区","3A景区","4A景区","5A景区"],"show-text":""},model:{value:e.ruleForm.scelevel,callback:function(t){e.$set(e.ruleForm,"scelevel",t)},expression:"ruleForm.scelevel"}})],1),a("el-form-item",{attrs:{label:"遗产简介",prop:"brief"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入遗产简介"},model:{value:e.ruleForm.brief,callback:function(t){e.$set(e.ruleForm,"brief",t)},expression:"ruleForm.brief"}})],1),a("el-form-item",{attrs:{label:"详细介绍",prop:"details"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入详细介绍"},model:{value:e.ruleForm.details,callback:function(t){e.$set(e.ruleForm,"details",t)},expression:"ruleForm.details"}})],1)],1),a("el-divider"),a("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择封面图片，注意封面图片仅允许上传一张，多次上传仅最后一张图会展示。为保证上传成功，图片大小建议小于3MB":"Please select a cover image. Note that only one cover image can be uploaded, and only the last image will be displayed after multiple uploads",type:"info"}}),a("br"),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.mainImage}}),a("br"),a("el-divider"),a("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择工业遗产详细图片，可以上传多张。为保证上传成功，图片大小建议小于3MB":"Please select a detailed picture of industrial heritage. You can upload multiple pictures",type:"info"}}),a("br"),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.addImagesAll}}),a("el-divider"),a("div",{staticClass:"subBtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("清空提示")])],1)],1)],1),a("div",{staticClass:"HeritageAdd-images"})])},s=[],n=a("1da1"),o=a("5530"),i=(a("ac1f"),a("5319"),a("1276"),a("d81d"),a("a15b"),a("b0c0"),a("96cf"),a("b2df")),l=a("2f62"),u={components:{MainTop:i["a"]},name:"HeritageAdd",computed:Object(o["a"])(Object(o["a"])({},Object(l["c"])(["lang"])),Object(l["c"])(["newCoordinate","instryType"])),created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.changeCoordinateType("add"),console.log(e.$route),"add"===e.$route.params.editid){t.next=25;break}if(a="","one"!==e.instryType){t.next=10;break}return t.next=7,e.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/getOneHeritageMainData/getOneHeritageMainData",{_id:e.$route.params.editid});case 7:a=t.sent,t.next=20;break;case 10:if("two"!==e.instryType){t.next=16;break}return t.next=13,e.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/getOneHeritageMuseum/getOneHeritageMuseum",{_id:e.$route.params.editid});case 13:a=t.sent,t.next=20;break;case 16:if("three"!==e.instryType){t.next=20;break}return t.next=19,e.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/getOneHeritageTourism/getOneHeritageTourism",{_id:e.$route.params.editid});case 19:a=t.sent;case 20:console.log(a.data.data),e.ruleForm=a.data.data[0],e.getCoordinate(a.data.data[0].coordinate),t.next=27;break;case 25:e.ruleForm.jing=e.newCoordinate[0],e.ruleForm.wei=e.newCoordinate[1];case 27:case"end":return t.stop()}}),t)})))()},data:function(){return{ruleForm:{addType:"",name:"",address:"",type:"",company:"",jing:0,wei:0,start:"",prolevel:"",trvlevel:"",scelevel:null,brief:"",details:"",mainImage:"",imagesAllurl:[],coordinate:[]},rules:{addType:[{required:!0,message:"请选择添加类型",trigger:"change"}],name:[{required:!0,message:"请输入工业遗产名称",trigger:"blur"},{min:3,message:"长度在不少于3个字符",trigger:"blur"}],address:[{required:!0,message:"请选择工业遗产所在地址",trigger:"change"}],type:[{required:!0,message:"请输入工业遗产类型",trigger:"change"}],company:[{required:!0,message:"请输入工业遗产所属公司",trigger:"change"}],start:[{required:!0,message:"请选择遗产始建年份",trigger:"change"}],brief:[{required:!0,message:"请输入工业遗产简介",trigger:"change"}],details:[{required:!0,message:"请输入工业遗产详细介绍",trigger:"change"}],jing:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}],wei:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}]}}},methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["getCoordinate","changeCoordinateType","getapplyCoordinate"])),{},{getCoordinateP:function(){this.getapplyCoordinate([]),this.$router.push("/get/coordinate")},formatTextarea:function(e){var t=/\n/g;e=e.replace(t,"<br>"),console.log(e.split("<br>"));var a=e.split("<br>"),r=a.map((function(e){return"<p class='test'>"+e+"</p>"})),s=r.join("");e=s,console.log()},submitForm:function(e){var t=this;console.log(this.ruleForm),this.$refs[e].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var r,s,n,o,i,l,u,c,m,p,d,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=51;break}if(""===t.ruleForm.mainImage||0===t.ruleForm.imagesAllurl.length){e.next=47;break}if(""!==t.ruleForm.brief?(r=/\n/g,t.ruleForm.brief=t.ruleForm.brief.replace(r,"<br>"),console.log(t.ruleForm.brief.split("<br>")),s=t.ruleForm.brief.split("<br>"),n=s.map((function(e){return"<p class='test'>"+e+"</p>"})),o=n.join(""),t.ruleForm.brief=o):t.$message.error("请完善遗产简介"),""!==t.ruleForm.details?(i=/\n/g,t.ruleForm.details=t.ruleForm.details.replace(i,"<br>"),console.log(t.ruleForm.details.split("<br>")),l=t.ruleForm.details.split("<br>"),u=l.map((function(e){return"<p class='test'>"+e+"</p>"})),c=u.join(""),t.ruleForm.details=c):t.$message.error("请完善遗产简介"),t.ruleForm.coordinate=[t.ruleForm.jing,t.ruleForm.wei],"add"===t.$route.params.editid){e.next=26;break}if("工业遗产"!==t.ruleForm.addType){e.next=12;break}return e.next=9,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/editHeritageMainData/editHeritageMainData",t.ruleForm);case 9:m=e.sent,console.log("res====",m),200===m.status&&(t.$message({message:"工业遗产信息编辑成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage"));case 12:if("遗产博物馆"!==t.ruleForm.addType){e.next=18;break}return e.next=15,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/editHeritageMuseum/editHeritageMuseum",t.ruleForm);case 15:m=e.sent,console.log("res====",m),200===m.status&&(t.$message({message:"遗产博物馆信息编辑成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage"));case 18:if("工业旅游区"!==t.ruleForm.addType){e.next=24;break}return e.next=21,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/editHeritageTourism/editHeritageTourism",t.ruleForm);case 21:m=e.sent,console.log("res====",m),200===m.status&&(t.$message({message:"工业旅游区信息编辑成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage"));case 24:e.next=45;break;case 26:if("工业遗产"!==t.ruleForm.addType){e.next=33;break}return e.next=29,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/postHeritageMainData/postHeritageMainData",t.ruleForm);case 29:p=e.sent,200===p.status&&(t.$message({message:"工业遗产信息添加成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage")),e.next=45;break;case 33:if("遗产博物馆"!==t.ruleForm.addType){e.next=40;break}return e.next=36,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/postHeritageMuseum/postHeritageMuseum",t.ruleForm);case 36:d=e.sent,200===d.status&&(t.$message({message:"遗产博物馆信息添加成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage")),e.next=45;break;case 40:if("工业旅游区"!==t.ruleForm.addType){e.next=45;break}return e.next=43,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/mainFun/postHeritageTourism/postHeritageTourism",t.ruleForm);case 43:g=e.sent,200===g.status&&(t.$message({message:"工业旅游区信息添加成功",type:"success"}),t.getCoordinate([]),t.$router.push("/data/manage"));case 45:e.next=48;break;case 47:t.$message.error("请上传遗产相关图片");case 48:console.log(t.ruleForm),e.next=53;break;case 51:return t.$message.error("请检查完善相关信息"),e.abrupt("return",!1);case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},mainImage:function(e){var t=this,a=e.target.files[0];console.log(a);var r=new FileReader;r.readAsDataURL(a),r.onload=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.src=r.target.result,e.next=3,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:s,name:a.name});case 3:n=e.sent,200===n.status?(console.log(n),t.$message({message:"图片上传成功",type:"success"}),t.ruleForm.mainImage=n.data.fileID):t.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},addImagesAll:function(e){var t=this,a=e.target.files[0];console.log(a);var r=new FileReader;r.readAsDataURL(a),r.onload=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.src=r.target.result,e.next=3,t.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:s,name:a.name});case 3:n=e.sent,200===n.status?(t.$message({message:"图片上传成功",type:"success"}),t.ruleForm.imagesAllurl.push(n.data.fileID)):t.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})},c=u,m=(a("003b"),a("2877")),p=Object(m["a"])(c,r,s,!1,null,null,null);t["default"]=p.exports},a2e1:function(e,t,a){},b2df:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-top"},[a("div",{staticClass:"main-top-left"},[a("span",{staticClass:"el-icon-arrow-left"}),a("span",[e._t("default")],2)]),a("div",{staticClass:"main-top-right"},[a("div",{staticClass:"btnBox"},[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"English")),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"zh_cn"}},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"Chinese"))]),a("el-dropdown-item",{attrs:{command:"zh_en"}},[e._v(" "+e._s("zh_cn"===e.lang?"英文":"English"))])],1)],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:e.leginOut}},[e._v(" "+e._s("zh_cn"===e.lang?"退出登陆":"SignOut"))])],1),a("el-avatar",{staticStyle:{"margin-left":"10px"},attrs:{shape:"square",size:"small",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-790d5b85-9674-4a89-9bcc-c0657ea369be/5f0c8b2c-22e0-42f3-9ed3-539de3652c08.jpg"}})],1)])},s=[],n=a("5530"),o=a("2f62"),i={name:"MainTop",created:function(){},computed:Object(n["a"])({},Object(o["c"])(["lang"])),methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])(["langChange"])),{},{handleCommand:function(e){this.langChange(e)},leginOut:function(){sessionStorage.removeItem("username"),this.$router.push("/heritage/login")}})},l=i,u=(a("13ee"),a("2877")),c=Object(u["a"])(l,r,s,!1,null,"0096d332",null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-bb225944.b6ba3a7c.js.map