(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34a9d248"],{"27c6":function(e,r,t){},"346b":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"heritage-apply"},[t("div",{staticClass:"heritage-apply-top"},[t("MainTop",[e._v("遗产申请 "),t("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" 遗产申报")])],1),t("div",{staticClass:"heritage-apply-bottom padding15"},[t("el-alert",{attrs:{title:"zh_cn"===e.lang?"为了您的申请能通过审核，请确保您的信息真实有效":"In order for your application to pass the examination, please ensure that your information is true and valid",type:"info"}}),t("br"),t("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.applyCoordinate.length,expression:"applyCoordinate.length === 0"}],attrs:{type:"primary"},on:{click:e.getapplyCoordinateP}},[e._v("点击拾取遗产坐标位置")]),t("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.applyCoordinate.length,expression:"applyCoordinate.length !== 0"}],staticClass:"main-box"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{size:"mini",model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"申请人姓名",prop:"applyName"}},[t("el-input",{attrs:{placeholder:"请输入申请人或申请公司"},model:{value:e.ruleForm.applyName,callback:function(r){e.$set(e.ruleForm,"applyName",r)},expression:"ruleForm.applyName"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{attrs:{placeholder:"手机号主要用于审核时与您的联系"},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{label:"添加类型",prop:"addType"}},[t("el-radio-group",{model:{value:e.ruleForm.addType,callback:function(r){e.$set(e.ruleForm,"addType",r)},expression:"ruleForm.addType"}},[t("el-radio",{attrs:{label:"工业遗产"}}),t("el-radio",{attrs:{label:"遗产博物馆"}}),t("el-radio",{attrs:{label:"工业旅游区"}})],1)],1),t("el-form-item",{attrs:{label:"遗产名称",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"坐标经度",prop:"jing"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.jing,callback:function(r){e.$set(e.ruleForm,"jing",r)},expression:"ruleForm.jing"}})],1),t("el-form-item",{attrs:{label:"坐标纬度",prop:"wei"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.wei,callback:function(r){e.$set(e.ruleForm,"wei",r)},expression:"ruleForm.wei"}}),t("el-button",{staticStyle:{"margin-left":"10px"},on:{click:e.getapplyCoordinateP}},[e._v("重新拾取")])],1),t("el-form-item",{attrs:{label:"所在地址",prop:"address"}},[t("el-input",{model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}})],1),t("el-form-item",{attrs:{label:"始建年份",prop:"start"}},[t("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"选择年"},model:{value:e.ruleForm.start,callback:function(r){e.$set(e.ruleForm,"start",r)},expression:"ruleForm.start"}})],1),t("el-form-item",{attrs:{label:"遗产类型",prop:"type"}},[t("el-input",{model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}})],1),t("el-form-item",{attrs:{label:"所属公司",prop:"company"}},[t("el-input",{model:{value:e.ruleForm.company,callback:function(r){e.$set(e.ruleForm,"company",r)},expression:"ruleForm.company"}})],1),t("el-form-item",{attrs:{label:"保护等级及再利用情况"}},[t("el-input",{model:{value:e.ruleForm.prolevel,callback:function(r){e.$set(e.ruleForm,"prolevel",r)},expression:"ruleForm.prolevel"}})],1),t("el-form-item",{attrs:{label:"工业旅游示范点等级"}},[t("el-input",{model:{value:e.ruleForm.trvlevel,callback:function(r){e.$set(e.ruleForm,"trvlevel",r)},expression:"ruleForm.trvlevel"}})],1),t("el-form-item",{attrs:{label:"旅游景区等级"}},[t("el-rate",{attrs:{texts:["1A景区","2A景区","3A景区","4A景区","5A景区"],"show-text":""},model:{value:e.ruleForm.scelevel,callback:function(r){e.$set(e.ruleForm,"scelevel",r)},expression:"ruleForm.scelevel"}})],1),t("el-form-item",{attrs:{label:"遗产简介",prop:"brief"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入遗产简介"},model:{value:e.ruleForm.brief,callback:function(r){e.$set(e.ruleForm,"brief",r)},expression:"ruleForm.brief"}})],1),t("el-form-item",{attrs:{label:"详细介绍",prop:"details"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入详细介绍"},model:{value:e.ruleForm.details,callback:function(r){e.$set(e.ruleForm,"details",r)},expression:"ruleForm.details"}})],1),t("el-divider"),t("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择封面图片，注意封面图片仅允许上传一张，多次上传仅最后一张图会展示":"Please select a cover image. Note that only one cover image can be uploaded, and only the last image will be displayed after multiple uploads",type:"info"}}),t("br"),t("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.mainImage}}),t("br"),t("el-divider"),t("el-alert",{attrs:{title:"zh_cn"===e.lang?"请选择工业遗产详细图片，可以上传多张":"Please select a detailed picture of industrial heritage. You can upload multiple pictures",type:"info"}}),t("br"),t("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.addImagesAll}}),t("el-divider"),t("div",{staticClass:"subBtn"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("清空提示")])],1)],1)],1)],1)])},l=[],o=t("1da1"),s=t("5530"),n=(t("ac1f"),t("5319"),t("1276"),t("d81d"),t("a15b"),t("b0c0"),t("96cf"),t("2f62")),i=t("b2df"),u={components:{MainTop:i["a"]},computed:Object(s["a"])({},Object(n["c"])(["lang","applyCoordinate"])),created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.$route.query.applyId){r.next=6;break}return r.next=3,e.$axios.post("/getOneApplyHeritage/getOneApplyHeritage",{_id:e.$route.query.applyId});case 3:t=r.sent,e.getapplyCoordinate(t.data.data[0].coordinate),e.ruleForm=Object(s["a"])({},t.data.data[0]);case 6:e.changeCoordinateType("apply"),e.ruleForm.jing=e.applyCoordinate[0],e.ruleForm.wei=e.applyCoordinate[1];case 9:case"end":return r.stop()}}),r)})))()},data:function(){return{ruleForm:{applyName:"",phone:"",addType:"",name:"",address:"",type:"",company:"",jing:0,wei:0,start:"",prolevel:"",trvlevel:"",scelevel:null,brief:"",details:"",mainImage:"",imagesAllurl:[],coordinate:[],approvalStatus:"pending",approvalComments:"",rejectComment:""},rules:{applyName:[{required:!0,message:"请输入申请人",trigger:"blur"}],phone:[{required:!0,message:"请输入正确手机号",trigger:"blur"}],addType:[{required:!0,message:"请选择添加类型",trigger:"change"}],name:[{required:!0,message:"请输入工业遗产名称",trigger:"blur"},{min:3,message:"长度在不少于3个字符",trigger:"blur"}],address:[{required:!0,message:"请选择工业遗产所在地址",trigger:"blur"}],type:[{required:!0,message:"请输入工业遗产类型",trigger:"blur"}],company:[{required:!0,message:"请输入工业遗产所属公司",trigger:"blur"}],start:[{required:!0,message:"请选择遗产始建年份",trigger:"blur"}],brief:[{required:!0,message:"请输入工业遗产简介",trigger:"blur"}],details:[{required:!0,message:"请输入工业遗产详细介绍",trigger:"blur"}],jing:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}],wei:[{required:!0,message:"请输入工业遗产坐标",trigger:"change"}]},editData:[]}},methods:Object(s["a"])(Object(s["a"])({},Object(n["b"])(["changeCoordinateType","getCoordinate","getapplyCoordinate"])),{},{getapplyCoordinateP:function(){this.getCoordinate([]),this.$router.push("/get/coordinate")},submitForm:function(e){var r=this;this.$refs[e].validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a,l,o,s,n,i,u,p,m,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=25;break}if(""===r.ruleForm.mainImage||0===r.ruleForm.imagesAllurl.length){e.next=22;break}if(""!==r.ruleForm.brief?(a=/\n/g,r.ruleForm.brief=r.ruleForm.brief.replace(a,"<br>"),console.log(r.ruleForm.brief.split("<br>")),l=r.ruleForm.brief.split("<br>"),o=l.map((function(e){return"<p class='test'>"+e+"</p>"})),s=o.join(""),r.ruleForm.brief=s):r.$message.error("请完善遗产简介"),""!==r.ruleForm.details?(n=/\n/g,r.ruleForm.details=r.ruleForm.details.replace(n,"<br>"),console.log(r.ruleForm.details.split("<br>")),i=r.ruleForm.details.split("<br>"),u=i.map((function(e){return"<p class='test'>"+e+"</p>"})),p=u.join(""),r.ruleForm.details=p):r.$message.error("请完善遗产简介"),r.ruleForm.coordinate=[r.ruleForm.jing,r.ruleForm.wei],console.log(r.ruleForm),r.$route.query.applyId){e.next=14;break}return e.next=9,r.$axios.post("/postApplyHeritageData/postApplyHeritageData",r.ruleForm);case 9:m=e.sent,console.log("res----",m),200===m.status&&(r.$message({message:"申报信息提交成功，请耐心等待审核",type:"success"}),r.getapplyCoordinate([]),r.getCoordinate([]),r.$router.push("/heritage/myapply")),e.next=20;break;case 14:return r.ruleForm.approvalStatus="pending",e.next=17,r.$axios.post("/editApplyHeritage/editApplyHeritage",r.ruleForm);case 17:c=e.sent,200===c.status&&(r.$message({message:"编辑信息提交成功，请耐心等待审核",type:"success"}),r.getapplyCoordinate([]),r.getCoordinate([]),r.$router.push("/heritage/myapply")),console.log(r.ruleForm);case 20:e.next=23;break;case 22:r.$message.error("请上传遗产相关图片");case 23:e.next=27;break;case 25:return console.log("error submit!!"),e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},mainImage:function(e){var r=this,t=e.target.files[0];console.log(t);var a=new FileReader;a.readAsDataURL(t),a.onload=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a){var l,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=r.src=a.target.result,e.next=3,r.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:l,name:t.name});case 3:o=e.sent,200===o.status?(console.log(o),r.$message({message:"图片上传成功",type:"success"}),r.ruleForm.mainImage=o.data.fileID):r.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},addImagesAll:function(e){var r=this,t=e.target.files[0];console.log(t);var a=new FileReader;a.readAsDataURL(t),a.onload=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a){var l,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=r.src=a.target.result,e.next=3,r.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:l,name:t.name});case 3:o=e.sent,200===o.status?(r.$message({message:"图片上传成功",type:"success"}),r.ruleForm.imagesAllurl.push(o.data.fileID)):r.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}})},p=u,m=t("2877"),c=Object(m["a"])(p,a,l,!1,null,null,null);r["default"]=c.exports},b2df:function(e,r,t){"use strict";var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"main-top"},[t("div",{staticClass:"main-top-left"},[t("span",{staticClass:"el-icon-arrow-left"}),t("span",[e._t("default")],2)]),t("div",{staticClass:"main-top-right"},[t("div",{staticClass:"btnBox"},[t("el-dropdown",{on:{command:e.handleCommand}},[t("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"English")),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"zh_cn"}},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"Chinese"))]),t("el-dropdown-item",{attrs:{command:"zh_en"}},[e._v(" "+e._s("zh_cn"===e.lang?"英文":"English"))])],1)],1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"}},[e._v(" "+e._s("zh_cn"===e.lang?"退出登陆":"SignOut"))])],1),t("el-avatar",{staticStyle:{"margin-left":"10px"},attrs:{shape:"square",size:"small",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-790d5b85-9674-4a89-9bcc-c0657ea369be/5f0c8b2c-22e0-42f3-9ed3-539de3652c08.jpg"}})],1)])},l=[],o=t("5530"),s=t("2f62"),n={name:"MainTop",created:function(){},computed:Object(o["a"])({},Object(s["c"])(["lang"])),methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])(["langChange"])),{},{handleCommand:function(e){this.langChange(e)}})},i=n,u=(t("cca8"),t("2877")),p=Object(u["a"])(i,a,l,!1,null,"5ccb1600",null);r["a"]=p.exports},cca8:function(e,r,t){"use strict";t("27c6")}}]);
//# sourceMappingURL=chunk-34a9d248.6b392cc1.js.map