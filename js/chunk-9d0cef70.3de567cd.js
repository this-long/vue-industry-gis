(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d0cef70"],{"011a":function(e,r,a){},"13ee":function(e,r,a){"use strict";a("011a")},b2df:function(e,r,a){"use strict";var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"main-top"},[a("div",{staticClass:"main-top-left"},[a("span",{staticClass:"el-icon-arrow-left"}),a("span",[e._t("default")],2)]),a("div",{staticClass:"main-top-right"},[a("div",{staticClass:"btnBox"},[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"English")),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"zh_cn"}},[e._v(" "+e._s("zh_cn"===e.lang?"中文":"Chinese"))]),a("el-dropdown-item",{attrs:{command:"zh_en"}},[e._v(" "+e._s("zh_cn"===e.lang?"英文":"English"))])],1)],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:e.leginOut}},[e._v(" "+e._s("zh_cn"===e.lang?"退出登陆":"SignOut"))])],1),a("el-avatar",{staticStyle:{"margin-left":"10px"},attrs:{shape:"square",size:"small",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-790d5b85-9674-4a89-9bcc-c0657ea369be/5f0c8b2c-22e0-42f3-9ed3-539de3652c08.jpg"}})],1)])},l=[],s=a("5530"),n=a("2f62"),o={name:"MainTop",created:function(){},computed:Object(s["a"])({},Object(n["c"])(["lang"])),methods:Object(s["a"])(Object(s["a"])({},Object(n["b"])(["langChange"])),{},{handleCommand:function(e){this.langChange(e)},leginOut:function(){sessionStorage.removeItem("username"),this.$router.push("/heritage/login")}})},i=o,p=(a("13ee"),a("2877")),u=Object(p["a"])(i,t,l,!1,null,"0096d332",null);r["a"]=u.exports},ebf8:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"apply-repair"},[a("div",{staticClass:"apply-repair-top"},[a("MainTop",[e._v("遗产申请 "),a("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" 遗产报修"),a("span",{staticClass:"gang"},[e._v(" / ")]),e._v(" 新建报修")])],1),a("div",{staticClass:"apply-repair-bottom padding15"},[a("br"),a("el-alert",{attrs:{title:"\n       请确保报修信息真实有效，否则您的申请可能会不被通过\n      ",type:"info"}}),a("br"),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{size:"mini",model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"申请人姓名",prop:"applyName"}},[a("el-input",{attrs:{placeholder:"请输入申请人或申请公司"},model:{value:e.ruleForm.applyName,callback:function(r){e.$set(e.ruleForm,"applyName",r)},expression:"ruleForm.applyName"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{placeholder:"手机号主要用于审核时与您的联系"},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),a("el-form-item",{attrs:{label:"申请分类",prop:"addType"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.addType,callback:function(r){e.$set(e.ruleForm,"addType",r)},expression:"ruleForm.addType"}})],1),a("el-form-item",{attrs:{label:"遗产名称",prop:"name"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"所在地址",prop:"address"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}})],1),a("el-form-item",{attrs:{label:"始建年份",prop:"start"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.start,callback:function(r){e.$set(e.ruleForm,"start",r)},expression:"ruleForm.start"}})],1),a("el-form-item",{attrs:{label:"遗产类型",prop:"type"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.type,callback:function(r){e.$set(e.ruleForm,"type",r)},expression:"ruleForm.type"}})],1),a("el-form-item",{attrs:{label:"所属公司",prop:"company"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.company,callback:function(r){e.$set(e.ruleForm,"company",r)},expression:"ruleForm.company"}})],1),a("el-form-item",{attrs:{label:"报修类型",prop:"repairType"}},[a("el-radio-group",{model:{value:e.ruleForm.repairType,callback:function(r){e.$set(e.ruleForm,"repairType",r)},expression:"ruleForm.repairType"}},[a("el-radio",{attrs:{label:"建筑修缮"}}),a("el-radio",{attrs:{label:"设备维修"}}),a("el-radio",{attrs:{label:"环境改造"}})],1)],1),a("el-form-item",{attrs:{label:"报修详情",prop:"repairMain"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入对于报修的详细描述"},model:{value:e.ruleForm.repairMain,callback:function(r){e.$set(e.ruleForm,"repairMain",r)},expression:"ruleForm.repairMain"}})],1),a("el-form-item",{attrs:{label:"是否自备材料及配件",prop:"isPart"}},[a("el-radio-group",{model:{value:e.ruleForm.isPart,callback:function(r){e.$set(e.ruleForm,"isPart",r)},expression:"ruleForm.isPart"}},[a("el-radio",{attrs:{label:"是"}}),a("el-radio",{attrs:{label:"否"}}),a("el-radio",{attrs:{label:"部分自备"}})],1)],1),"是"!==e.ruleForm.isPart?a("el-form-item",{attrs:{label:"材料详情"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入对于维修材料的详细描述"},model:{value:e.ruleForm.partMain,callback:function(r){e.$set(e.ruleForm,"partMain",r)},expression:"ruleForm.partMain"}})],1):e._e(),a("el-divider"),a("el-alert",{attrs:{title:"如有请上传相关图片，可上传多张",type:"info"}}),a("br"),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:e.addImagesAll}}),a("el-divider"),a("div",{staticClass:"subBtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")])],1)],1)],1)])},l=[],s=a("5530"),n=a("1da1"),o=(a("b0c0"),a("ac1f"),a("5319"),a("1276"),a("d81d"),a("a15b"),a("96cf"),a("b2df")),i={components:{MainTop:o["a"]},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log(e.$route.query),!e.$route.query.applyId){r.next=8;break}return r.next=4,e.$axios.post("/getOneApplyRepair/getOneApplyRepair",{_id:e.$route.query.applyId});case 4:a=r.sent,e.ruleForm=Object(s["a"])({},a.data.data[0]),r.next=9;break;case 8:e.getData();case 9:case"end":return r.stop()}}),r)})))()},data:function(){return{data:[],ruleForm:{applyName:"",phone:"",addType:"",name:"",address:"",type:"",company:"",jing:0,wei:0,start:"",mainImage:"",coordinate:[],approvalStatus:"pending",approvalComments:"",rejectComment:"",repairType:"",repairMain:"",imagesAllurl:[],isPart:"是",partMain:""},rules:{applyName:[{required:!0,message:"请输入申请人",trigger:"blur"}],phone:[{required:!0,message:"请输入正确手机号",trigger:"blur"}],addType:[{required:!0,message:"请选择添加类型",trigger:"change"}],name:[{required:!0,message:"请输入工业遗产名称",trigger:"blur"},{min:3,message:"长度在不少于3个字符",trigger:"blur"}],address:[{required:!0,message:"请选择工业遗产所在地址",trigger:"blur"}],type:[{required:!0,message:"请输入工业遗产类型",trigger:"blur"}],company:[{required:!0,message:"请输入工业遗产所属公司",trigger:"blur"}],start:[{required:!0,message:"请选择遗产始建年份",trigger:"blur"}],repairType:[{required:!0,message:"请选择报修类型",trigger:"blur"}],repairMain:[{required:!0,message:"请输入报修详情",trigger:"blur"}],isPart:[{required:!0,message:"请确定是否需要维修材料",trigger:"blur"}]}}},methods:{getData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a="","工业遗产"!==e.$route.query.addType){r.next=5;break}return r.next=4,e.$axios.post("/getOneHeritageMainData/getOneHeritageMainData",{_id:e.$route.query._id});case 4:a=r.sent;case 5:e.data=a.data.data[0],e.ruleForm.addType=e.data.addType,e.ruleForm.name=e.data.name,e.ruleForm.address=e.data.address,e.ruleForm.type=e.data.type,e.ruleForm.company=e.data.company,e.ruleForm.jing=e.data.jing,e.ruleForm.wei=e.data.wei,e.ruleForm.start=e.data.start,e.ruleForm.mainImage=e.data.mainImage,e.ruleForm.coordinate=e.data.coordinate,console.log(e.data);case 17:case"end":return r.stop()}}),r)})))()},submitForm:function(e){var r=this;this.$refs[e].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var t,l,n,o,i,p,u,m,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=18;break}if(console.log(r.ruleForm),""!==r.ruleForm.repairMain&&(t=/\n/g,r.ruleForm.repairMain=r.ruleForm.repairMain.replace(t,"<br>"),console.log(r.ruleForm.repairMain.split("<br>")),l=r.ruleForm.repairMain.split("<br>"),n=l.map((function(e){return"<p class='test'>"+e+"</p>"})),o=n.join(""),r.ruleForm.repairMain=o),""!==r.ruleForm.partMain&&(i=/\n/g,r.ruleForm.partMain=r.ruleForm.partMain.replace(i,"<br>"),console.log(r.ruleForm.partMain.split("<br>")),p=r.ruleForm.partMain.split("<br>"),u=p.map((function(e){return"<p class='test'>"+e+"</p>"})),m=u.join(""),r.ruleForm.partMain=m),!r.$route.query.applyId){e.next=12;break}return r.ruleForm.approvalStatus="pending",e.next=8,r.$axios.post("/editApplyRepair/editApplyRepair",Object(s["a"])(Object(s["a"])({},r.ruleForm),{},{user:sessionStorage.getItem("username")}));case 8:c=e.sent,200===c.status&&(r.$message({message:"编辑成功",type:"success"}),r.$router.push({path:"/repair/my/applyRepair"})),e.next=16;break;case 12:return e.next=14,r.$axios.post("/postApplyRepairData/postApplyRepairData",Object(s["a"])(Object(s["a"])({},r.ruleForm),{},{user:sessionStorage.getItem("username")}));case 14:d=e.sent,200===d.status&&(r.$message({message:"报修信息提交成功，请耐心等待审核",type:"success"}),r.$router.push("/repair/my/applyRepair"));case 16:e.next=20;break;case 18:return console.log("error submit!!"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},addImagesAll:function(e){var r=this,a=e.target.files[0];console.log(a);var t=new FileReader;t.readAsDataURL(a),t.onload=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l=r.src=t.target.result,e.next=3,r.$axios.post("https://790d5b85-9674-4a89-9bcc-c0657ea369be.bspapp.com/image",{dataUrl:l,name:a.name});case 3:s=e.sent,200===s.status?(r.$message({message:"图片上传成功",type:"success"}),r.ruleForm.imagesAllurl.push(s.data.fileID)):r.$message.error("图片上传失败，请检查网络设置");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}}},p=i,u=a("2877"),m=Object(u["a"])(p,t,l,!1,null,null,null);r["default"]=m.exports}}]);
//# sourceMappingURL=chunk-9d0cef70.3de567cd.js.map